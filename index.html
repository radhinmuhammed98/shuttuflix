<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PookieStream</title>
  <!-- ✅ FIXED FONT AWESOME CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    :root {
      --stranger-red: #ff0a26;
      --stranger-red-glow: rgba(255, 10, 38, 0.7);
      --stranger-black: #0a0a0a;
      --stranger-dark: #121212;
      --stranger-gray: #222;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--stranger-black);
      color: white;
      font-family: Arial, sans-serif;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(255, 10, 38, 0.05) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(255, 10, 38, 0.05) 0%, transparent 20%);
    }

    .neon-glow {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: -1; opacity: 0.1;
      background: 
        radial-gradient(circle at 10% 10%, var(--stranger-red) 0%, transparent 40%),
        radial-gradient(circle at 90% 10%, var(--stranger-red) 0%, transparent 40%);
      animation: pulse 8s infinite alternate;
    }
    @keyframes pulse {
      0% { opacity: 0.05; } 100% { opacity: 0.15; }
    }

    header {
      background: rgba(10, 10, 10, 0.95);
      padding: 1.2rem;
      position: sticky; top: 0; z-index: 100;
      border-bottom: 2px solid var(--stranger-red);
    }

    .header-content {
      display: flex; justify-content: space-between; align-items: center;
      max-width: 1200px; margin: 0 auto;
    }

    .logo {
      font-family: 'Arial Black', sans-serif;
      font-size: 2rem; color: var(--stranger-red);
      text-shadow: 0 0 8px var(--stranger-red), 0 0 16px var(--stranger-red);
      letter-spacing: -1px;
    }

    .search-container {
      position: relative; width: 60%; max-width: 500px;
    }

    .search-box {
      width: 100%; padding: 0.7rem 1.5rem 0.7rem 2.5rem;
      background: var(--stranger-gray); border: 2px solid var(--stranger-red);
      border-radius: 30px; color: white; outline: none;
      box-shadow: 0 0 10px rgba(255, 10, 38, 0.3);
    }

    .search-icon {
      position: absolute; left: 15px; top: 50%; transform: translateY(-50%);
      color: var(--stranger-red);
    }

    .voice-search {
      position: absolute; right: 15px; top: 50%; transform: translateY(-50%);
      background: none; border: none; color: var(--stranger-red);
      font-size: 1.2rem; cursor: pointer;
    }

    main {
      padding: 2rem; max-width: 1200px; margin: 0 auto;
    }

    .section-title {
      text-align: center; color: var(--stranger-red);
      margin: 1.5rem 0; font-size: 1.8rem;
      text-shadow: 0 0 10px var(--stranger-red-glow);
    }

    .movie-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 1.8rem; padding: 1rem 0;
    }

    .movie-card {
      background: var(--stranger-gray);
      border-radius: 10px; overflow: hidden;
      transition: all 0.3s ease; cursor: pointer;
      border: 1px solid rgba(255, 10, 38, 0.3);
    }

    .movie-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 5px 20px var(--stranger-red-glow);
    }

    .movie-poster {
      width: 100%; height: 240px; object-fit: cover;
      display: block;
    }

    .movie-title {
      padding: 0.8rem; text-align: center; font-size: 0.95rem;
      min-height: 50px; display: flex; align-items: center; justify-content: center;
    }

    .modal {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.9); display: flex; align-items: center;
      justify-content: center; z-index: 1000; opacity: 0; visibility: hidden;
      transition: all 0.3s ease;
    }

    .modal.active {
      opacity: 1; visibility: visible;
    }

    .modal-content {
      width: 90%; max-width: 800px; background: var(--stranger-dark);
      border: 2px solid var(--stranger-red); border-radius: 8px;
      overflow: hidden;
    }

    .modal-header {
      padding: 1rem 1.5rem; display: flex; justify-content: space-between;
      background: rgba(255, 10, 38, 0.1);
    }

    .modal-title {
      color: var(--stranger-red); font-size: 1.4rem;
    }

    .close-modal {
      background: none; border: none; color: var(--stranger-red);
      font-size: 1.8rem; cursor: pointer;
    }

    .player-container {
      position: relative; padding-top: 56.25%;
    }

    .player-iframe {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      border: none;
    }

    .no-results, .loading {
      text-align: center; padding: 3rem; color: var(--stranger-red);
      font-size: 1.3rem;
    }

    footer {
      text-align: center; padding: 2rem; color: #777; font-size: 0.9rem;
      border-top: 1px solid rgba(255,10,38,0.2);
    }

    @media (max-width: 768px) {
      .header-content { flex-direction: column; gap: 1rem; }
      .search-container { width: 100%; }
      .movie-grid { grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); }
    }
  </style>
</head>
<body>
  <div class="neon-glow"></div>
  
  <header>
    <div class="header-content">
      <div class="logo">POOKIESTREAM</div>
      <div class="search-container">
        <i class="fas fa-search search-icon"></i>
        <input type="text" id="search-input" class="search-box" placeholder="Search for movies...">
        <button id="voice-search" class="voice-search">
          <i class="fas fa-microphone"></i>
        </button>
      </div>
    </div>
  </header>
  
  <main>
    <h2 class="section-title">NOW STREAMING</h2>
    <div id="loading" class="loading">Loading content<span id="dots"></span></div>
    <div id="movie-grid" class="movie-grid"></div>
    <div id="no-results" class="no-results" style="display:none;">
      No results found, Stranger... TRY AGAIN
    </div>
  </main>
  
  <div id="player-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="modal-title">MOVIE</h3>
        <button class="close-modal" id="close-modal">&times;</button>
      </div>
      <div class="player-container">
        <iframe id="player-iframe" class="player-iframe" allowfullscreen></iframe>
      </div>
    </div>
  </div>
  
  <footer>
    <p>PookieStream &copy; 2026 — Demo site only</p>
  </footer>

  <script>
    // ✅ NO API KEY NEEDED — using public demo API
    const SEARCH_API = 'https://moviesapi.cyclic.app/search?q=';
    
    // DOM Elements (only declared once!)
    const searchInput = document.getElementById('search-input');
    const voiceSearchBtn = document.getElementById('voice-search');
    const movieGrid = document.getElementById('movie-grid');
    const noResults = document.getElementById('no-results');
    const loading = document.getElementById('loading');
    const playerModal = document.getElementById('player-modal');
    const closeModal = document.getElementById('close-modal');
    const modalTitle = document.getElementById('modal-title');
    const playerIframe = document.getElementById('player-iframe');
    
    // Loading dots animation
    const dots = document.getElementById('dots');
    let dotCount = 0;
    setInterval(() => {
      dots.textContent = '.'.repeat(++dotCount % 4);
    }, 500);

    // Fetch and display movies
    async function searchMovies(query) {
      toggleLoading(true);
      
      try {
        const res = await fetch(SEARCH_API + encodeURIComponent(query));
        const data = await res.json();
        
        if (data.results && data.results.length > 0) {
          displayMovies(data.results);
          noResults.style.display = 'none';
        } else {
          movieGrid.innerHTML = '';
          noResults.style.display = 'block';
        }
      } catch (err) {
        console.error('Search error:', err);
        movieGrid.innerHTML = '';
        noResults.style.display = 'block';
        noResults.textContent = 'Oops! Server error. Try again.';
      } finally {
        toggleLoading(false);
      }
    }
    
    function toggleLoading(show) {
      loading.style.display = show ? 'block' : 'none';
    }
    
    function displayMovies(movies) {
      movieGrid.innerHTML = '';
      
      movies.slice(0, 20).forEach(movie => {
        const { id, title, poster_path } = movie;
        if (!poster_path) return;
        
        const card = document.createElement('div');
        card.className = 'movie-card';
        card.innerHTML = `
          <img class="movie-poster" src="https://image.tmdb.org/t/p/w500${poster_path}" alt="${title}">
          <div class="movie-title">${title}</div>
        `;
        
        card.addEventListener('click', () => openPlayer(id, title));
        movieGrid.appendChild(card);
      });
    }
    
    function openPlayer(tmdbId, title) {
      modalTitle.textContent = title;
      // VidKing embed URL with autoPlay and red color
      playerIframe.src = `https://www.vidking.net/embed/movie/${tmdbId}?autoPlay=true&color=ff0000`;
      playerModal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    function closePlayer() {
      playerModal.classList.remove('active');
      document.body.style.overflow = 'auto';
      playerIframe.src = ''; // stops video
    }
    
    // Search with debounce
    let debounceTimer;
    searchInput.addEventListener('input', (e) => {
      clearTimeout(debounceTimer);
      const query = e.target.value.trim();
      
      if (query === '') {
        movieGrid.innerHTML = '';
        noResults.style.display = 'none';
        return;
      }
      
      debounceTimer = setTimeout(() => {
        searchMovies(query);
      }, 500);
    });
    
    // Voice search (Chrome only)
    voiceSearchBtn.addEventListener('click', () => {
      if (!('webkitSpeechRecognition' in window)) {
        alert('Voice search works only in Chrome/Edge.');
        return;
      }
      
      const recog = new webkitSpeechRecognition();
      recog.lang = 'en-US';
      recog.start();
      
      recog.onresult = (e) => {
        searchInput.value = e.results[0][0].transcript;
        searchMovies(searchInput.value);
      };
    });
    
    // Modal controls
    closeModal.addEventListener('click', closePlayer);
    playerModal.addEventListener('click', (e) => {
      if (e.target === playerModal) closePlayer();
    });
    
    // Close with ESC
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closePlayer();
    });
    
    // Load popular movies on start
    window.addEventListener('DOMContentLoaded', () => {
      searchMovies('stranger'); // Good default for theme
    });
  </script>
</body>
</html>
